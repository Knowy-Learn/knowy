<div th:fragment="options-quiz(options)" class="options-quiz">
	<button th:each="option : ${options}"
			class="quiz-option"
			type="button"
			th:text="${'-' + ' ' + option.text}"
			th:data-correct="${option.isCorrect}">
	</button>

	<!--NAVIGATION BUTTONS-->
		<div class="answer-button">
			<button class="answer-button__element" type="button" data-bs-target="#exampleModal" data-bs-toggle="modal">Responder</button>
		</div>

	<script>
		(() => {

			/** Función auxiliar: devuelve el contenedor .options-quiz de un elemento */
			const getQuizBox = el => el.closest('.options-quiz');

			/** Manejamos la selección de una opción */
			document.addEventListener('click', e => {
				const optionBtn = e.target.closest('.quiz-option');
				if (!optionBtn) return;                       // no se hizo clic en una opción

				const box = getQuizBox(optionBtn);
				if (box.dataset.answered === 'true') return;  // ya respondido

				// Desmarcar anteriores y marcar la nueva
				box.querySelectorAll('.quiz-option').forEach(b => b.classList.remove('selected'));
				optionBtn.classList.add('selected');
				box.dataset.selected = optionBtn.dataset.correct;   // "true" | "false"
				box.dataset.selectedId = optionBtn.dataset.buttonId = Date.now(); // id único por si hace falta
			});

			/** Manejamos el clic en "Responder" */
			document.addEventListener('click', e => {
				const checkBtn = e.target.closest('.answer-button__element');
				if (!checkBtn) return;                        // clic en otra cosa

				const box = getQuizBox(checkBtn);
				if (box.dataset.answered === 'true')   return; // ya respondido
				if (!box.dataset.selectedId)           return; // aún no eligió opción

				box.dataset.answered = 'true';

				const selected   = box.querySelector('.quiz-option.selected');
				const optionBtns = box.querySelectorAll('.quiz-option');

				optionBtns.forEach(btn => {
					const isCorrect = btn.dataset.correct === 'true';
					if (btn === selected) {
						btn.classList.add(isCorrect ? 'correct' : 'incorrect');
					} else if (isCorrect) {
						btn.classList.add('correct');
					}
				});
			});

		})();
	</script>

</div>




