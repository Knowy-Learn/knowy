<!DOCTYPE html>
<html lang="es"
	  layout:decorate="~{layouts/content-sidebar-layout}"
	  xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
	  xmlns:th="http://www.thymeleaf.org">
<head>
	<script src="https://code.jquery.com/jquery-3.5.1.slim.min.js" integrity="..." crossorigin="anonymous"></script>
	<script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/js/bootstrap.bundle.min.js" integrity="..." crossorigin="anonymous"></script>
	<script>

		function verifyPassword() {
			const password = document.getElementById('newPassword').value;
			const advice = document.getElementById('passwordAdvice1');

			// Regular expressions for each requirement
			const minLength = password.length >= 8;
			//TODO in the future
			const hasUpper = /[A-Z]/.test(password);
			const hasLower = /[a-z]/.test(password);
			const hasNumber = /[0-9]/.test(password);
			const hasSymbol = /[^A-Za-z0-9]/.test(password);

			if (minLength && hasUpper && hasLower && hasNumber && hasSymbol) {
				advice.style.color = "green";
				advice.textContent = "Â¡ContraseÃ±a vÃ¡lida!";
			} else {
				advice.style.color = "red";
				advice.textContent = "MÃ­nimo 8 caracteres que contengan MayÃºsculas, MinÃºsculas, NÃºmeros y SÃ­mbolos.";
			}
		}

		function checkNewPassword() {
			const passwordNew = document.getElementById('newPassword').value;
			const passwordConfirmation = document.getElementById('confirmPassword').value;
			const advice2 = document.getElementById('passwordAdvice2');
			if (passwordNew === passwordConfirmation) {
				advice2.style.color = "green";
				advice2.textContent = "Â¡Las contraseÃ±as coinciden!";
			}else{
				advice2.style.color = "red";
				advice2.textContent = "Â¡Las contraseÃ±as no coinciden!"
			}
		}
	</script>
	<link rel="stylesheet" th:href="@{/styles/pages/user-management.css}">
	<title>User profile</title>
</head>

<body>

<aside layout:fragment="sidebar" class="kn-aside user-sidebar">
	<div class="user-info text-center mb-4">
		<h3 class="mt-3 usernameTitle" th:text="${username}">Usuario</h3>
	</div>
	<div class="sidebar-menu">
		<a th:href="@{/user-profile}" class="button sidebar-link but"  data-sidebar-toggler="">Editar Perfil</a>
		<button class="sidebar-link" data-sidebar-toggler="" th:classappend="active">GestiÃ³n de la Cuenta</button>
	</div>
</aside>

<main layout:fragment="main-content">
	<form id="profileForm">
		<div class="user-management-container_main ">
			<div class="description-card">
				<h1 class="title-management">GestiÃ³n de la Cuenta</h1>
			</div>
			<form id="accountForm">
				<div class="row user-information">
					<div class="form-fields">
						<label for="privateName" class="section-title">Nombre de Usuario Privado ðŸ‘¤</label>
						<input type="text" class="form-control" id="privateName" th:value="${username}" required>
					</div>

					<div class="form-fields">
						<label for="email" class="section-title">Correo ElectrÃ³nico ðŸ“§</label>
						<input type="email" class="form-control" id="email" th:value="${email}" required>
					</div>

					<div class="form-fields">
						<label for="currentPassword" class="section-title">ContraseÃ±a actualðŸ”‘</label>
						<input type="password" class="form-control" id="currentPassword" name="currentPassword">
						<div id="advice0" class="advice"></div>
					</div>

					<div class="form-fields">
						<label for="newPassword" class="section-title">ContraseÃ±a nuevaðŸ”‘</label>
						<input type="password" class="form-control" id="newPassword" name="newPassword" oninput="verifyPassword()">
						<div id="passwordAdvice1" class="advice">MÃ­nimo 8 caracteres que contengan MayÃºsculas, MinÃºsculas, NÃºmeros y SÃ­mbolos.</div>
					</div>

					<div class="form-fields">
						<label for="confirmPassword" class="section-title">Confirmar ContraseÃ±a nuevaðŸ”‘</label>
						<input type="password" class="form-control" id="confirmPassword" name="confirmPassword" oninput="checkNewPassword()">
						<div id="passwordAdvice2" class="advice"></div>
					</div>
				</div>
				<div class="buttons-form-content">
					<button type="reset" class="btn btn-inferior">Restablecer</button>
					<button type="submit" class="btn btn-save">Guardar Cambios</button>
				</div>
			</form>
			<div class="delete-section">
				<div class="description-card delete">
					<h3 class="title-delete">DesactivaciÃ³n y eliminaciÃ³n de la cuenta</h3>
				</div>
				<p class="description-management">Elimina permanentemente tus datos y todo lo asociado con tu cuenta.</p>
				<br>
				<a th:href="@{/delete-account}" class="btn btn-delete">Eliminar cuenta</a>
			</div>
		</div>
	</form>
</main>



</body>
</html>
